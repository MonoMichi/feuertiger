# Migration `20200618110524-4f5a92c`

This migration has been generated by thaneim at 6/18/2020, 11:05:24 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Grade" AS ENUM ('FA', 'FM', 'OFM', 'HFM', 'LM', 'OLM', 'HLM', 'BM', 'OBM', 'HBM');

CREATE TABLE "public"."Exercise" (
"id" text  NOT NULL ,"timeslotId" text  NOT NULL ,"topic" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Address" (
"city" text  NOT NULL ,"country" text  NOT NULL ,"id" text  NOT NULL ,"postalCode" text  NOT NULL ,"street" text  NOT NULL ,"streetNumber" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Membership" (
"active" boolean  NOT NULL ,"departureDate" text   ,"entryDate" text  NOT NULL ,"id" text  NOT NULL ,"personId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Promotion" (
"dateOfPromotion" text  NOT NULL ,"grade" "Grade" NOT NULL ,"id" text  NOT NULL ,"personId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Person" (
"addressId" text  NOT NULL ,"avatar" text  NOT NULL ,"birthName" text  NOT NULL ,"dateOfBirth" text  NOT NULL ,"firstname" text  NOT NULL ,"grade" "Grade" NOT NULL ,"id" text  NOT NULL ,"lastname" text  NOT NULL ,"membershipNumber" text  NOT NULL ,"placeOfBirth" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Timeslot" (
"end" timestamp(3)  NOT NULL ,"id" text  NOT NULL ,"start" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_Exercise_Leader" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_Exercise_Participant" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE UNIQUE INDEX "_Exercise_Leader_AB_unique" ON "public"."_Exercise_Leader"("A","B")

CREATE  INDEX "_Exercise_Leader_B_index" ON "public"."_Exercise_Leader"("B")

CREATE UNIQUE INDEX "_Exercise_Participant_AB_unique" ON "public"."_Exercise_Participant"("A","B")

CREATE  INDEX "_Exercise_Participant_B_index" ON "public"."_Exercise_Participant"("B")

ALTER TABLE "public"."Exercise" ADD FOREIGN KEY ("timeslotId")REFERENCES "public"."Timeslot"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Membership" ADD FOREIGN KEY ("personId")REFERENCES "public"."Person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Promotion" ADD FOREIGN KEY ("personId")REFERENCES "public"."Person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Person" ADD FOREIGN KEY ("addressId")REFERENCES "public"."Address"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_Exercise_Leader" ADD FOREIGN KEY ("A")REFERENCES "public"."Exercise"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_Exercise_Leader" ADD FOREIGN KEY ("B")REFERENCES "public"."Person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_Exercise_Participant" ADD FOREIGN KEY ("A")REFERENCES "public"."Exercise"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_Exercise_Participant" ADD FOREIGN KEY ("B")REFERENCES "public"."Person"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200618110524-4f5a92c
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,82 @@
+datasource postgresql {
+  url      = "postgresql://feuertiger:feuertiger@localhost:5432/feuertiger"
+  provider = "postgresql"
+}
+
+generator client {
+  provider = "prisma-client-js"
+  output   = "../dist"
+}
+
+model Exercise {
+  id           String   @id
+  topic        String
+  timeslot     Timeslot @relation(fields: [timeslotId], references: [id])
+  timeslotId   String
+  leaders      Person[] @relation("Exercise_Leader", references: [id])
+  participants Person[] @relation("Exercise_Participant", references: [id])
+}
+
+model Address  {
+  id           String   @id
+  street       String
+  streetNumber String
+  postalCode   String
+  city         String
+  country       String
+}
+
+model Membership {
+  id              String    @id
+  active          Boolean
+  entryDate       String
+  personId        String
+  person          Person    @relation("Person_Membership", fields: [personId])
+  departureDate   String?
+}
+
+enum Grade {
+  FA
+  FM
+  OFM
+  HFM
+  LM
+  OLM
+  HLM
+  BM
+  OBM
+  HBM
+}
+
+model Promotion   {
+  id                String    @id
+  dateOfPromotion   String
+  personId          String
+  person            Person    @relation("Person_Promotion", fields: [personId])
+  grade             Grade
+}
+
+model Person {
+  id                      String      @id
+  firstname               String
+  lastname                String
+  birthName               String
+  placeOfBirth            String
+  avatar                  String
+  dateOfBirth             String
+  membershipNumber        String
+  grade                   Grade
+  addressId               String
+  address                 Address       @relation(fields: [addressId], references: [id])
+  memberships             Membership[]  @relation("Person_Membership")
+  promotions              Promotion[]   @relation("Person_Promotion")
+  exercisesParticipated   Exercise[]    @relation("Exercise_Participant", references: [id])
+  exercisesLeaded         Exercise[]    @relation("Exercise_Leader", references: [id])
+}
+
+model Timeslot {
+  id       String     @id
+  start    DateTime
+  end      DateTime
+  Exercise Exercise[]
+}
```


